{"version":3,"sources":["webpack:///./src/views/Checkout.vue","webpack:///./src/views/Checkout.vue?7901","webpack:///./node_modules/core-js/modules/es.function.name.js"],"names":["class","style","for","id","cols","rows","href","type","active","isLoading","toOrder","errors","name","form","user","email","rules","placeholder","tel","address","carts","data","item","key","src","product","imageUrl","alt","title","price","qty","totalPrice","coupon","aria-label","aria-describedby","sendCoupon","salePrice","Math","round","setup","router","mitt","axios","getCart","api","value","get","then","res","getTotalPrice","forEach","total","code","post","success","final_total","emit","push","orderId","render","DESCRIPTORS","defineProperty","f","FunctionPrototype","Function","prototype","FunctionPrototypeToString","toString","nameRE","NAME","configurable","call","this","match","error"],"mappings":"sJAEOA,MAAM,Y,EACT,yBAAmC,OAA9BA,MAAM,mBAAiB,S,GACvBA,MAAM,kB,GACJA,MAAM,Y,GACJA,MAAM,4C,EACT,yBAA8B,MAA1BA,MAAM,WAAU,SAAK,G,EACzB,yBAAyC,MAArCA,MAAM,UAAUC,MAAA,e,YAEbD,MAAM,Q,EACT,yBAEC,SAFME,IAAI,QAAQF,MAAM,sB,CACtB,yBAAkC,QAA5BA,MAAM,eAAc,K,6BAAQ,Y,MAclCA,MAAM,Q,EACT,yBAEC,SAFME,IAAI,OAAOF,MAAM,sB,CACrB,yBAAkC,QAA5BA,MAAM,eAAc,K,6BAAQ,Y,MAelCA,MAAM,Q,EACT,yBAEC,SAFME,IAAI,MAAMF,MAAM,sB,CACpB,yBAAkC,QAA5BA,MAAM,eAAc,K,6BAAQ,Y,MAclCA,MAAM,Q,EACT,yBAEC,SAFME,IAAI,UAAUF,MAAM,sB,CACxB,yBAAkC,QAA5BA,MAAM,eAAc,K,6BAAQ,Y,KAcvC,yBAGM,OAHDA,MAAM,QAAM,CACf,yBAA+D,SAAxDE,IAAI,UAAUF,MAAM,sBAAqB,WAChD,yBAA2E,YAAjEG,GAAG,UAAUH,MAAM,eAAeI,KAAK,KAAKC,KAAK,S,KAE7D,yBAKM,OALDL,MAAM,kCAAgC,CACzC,yBAEC,KAFEM,KAAK,SAASN,MAAM,+CACpB,OAEH,yBAAqH,UAA7GO,KAAK,SAASP,MAAM,8EAA6E,S,MAI1GA,MAAM,Y,GACJA,MAAM,S,EACT,yBAAyC,MAArCA,MAAM,uBAAsB,QAAI,G,EACpC,yBAAyC,MAArCA,MAAM,UAAUC,MAAA,e,YAObD,MAAM,uC,GACHA,MAAM,W,GACNA,MAAM,uB,GAETA,MAAM,uB,GAETA,MAAM,sB,GACJA,MAAM,+C,EACR,yBAAS,SAAN,MAAE,G,GAGHA,MAAM,0C,EACR,yBAAU,SAAP,OAAG,G,SACHA,MAAM,gB,SACNA,MAAM,gB,EAGb,yBAEC,SAFMA,MAAM,kDACV,gBAAY,G,GAEVA,MAAM,oB,EAWX,yBAAyC,MAArCA,MAAM,UAAUC,MAAA,e,YACfD,MAAM,wC,EACT,yBAA4B,MAAxBA,MAAM,WAAU,OAAG,G,SACjBA,MAAM,gB,SACNA,MAAM,gB,SAETA,MAAM,uC,EACT,yBAAwC,MAApCA,MAAM,uBAAsB,OAAG,G,SAC7BA,MAAM,4B,SACNA,MAAM,4B,sRAxIxB,yBAAuC,GAA7BQ,OAAQ,EAAAC,WAAS,mBAC3B,yBA6IM,MA7IN,EA6IM,CA5IJ,EACA,yBA0IM,MA1IN,EA0IM,CAzIJ,yBAwIM,MAxIN,EAwIM,CAvIJ,yBAgFM,MAhFN,EAgFM,CA/EJ,EACA,EACA,yBA4EO,GA5EoB,SAAQ,EAAAC,SAAO,C,8BACxC,gBADcC,EACd,EADcA,OACd,MADoB,CACpB,yBAeM,MAfN,EAeM,CAdJ,EAGA,yBASS,GARPR,GAAG,QACHS,KAAK,QACLL,KAAK,QACLP,MAAK,CAAC,eAAc,cAEIW,EAAO,W,WADtB,EAAAE,KAAKC,KAAKC,M,qDAAV,EAAAF,KAAKC,KAAKC,MAAK,IAExBC,MAAM,iBACNC,YAAY,a,+BAEd,yBAAqE,GAAtDL,KAAK,QAAQZ,MAAM,uBAEpC,yBAeM,MAfN,EAeM,CAdJ,EAGA,yBASS,GARPG,GAAG,OACHS,KAAK,KACLL,KAAK,O,WACI,EAAAM,KAAKC,KAAKF,K,qDAAV,EAAAC,KAAKC,KAAKF,KAAI,IACvBZ,MAAK,CAAC,eAAc,cAEIW,EAAO,QAD/BM,YAAY,QAEZD,MAAM,Y,+BAER,yBAAkE,GAAnDJ,KAAK,KAAKZ,MAAM,uBAGjC,yBAeM,MAfN,EAeM,CAdJ,EAGA,yBASS,GARPG,GAAG,MACHS,KAAK,KACLL,KAAK,OACLP,MAAK,CAAC,eAAc,cAGIW,EAAO,Q,WAFtB,EAAAE,KAAKC,KAAKI,I,qDAAV,EAAAL,KAAKC,KAAKI,IAAG,IACtBD,YAAY,QAEZD,MAAM,yB,+BAER,yBAAkE,GAAnDJ,KAAK,KAAKZ,MAAM,uBAEjC,yBAeM,MAfN,EAeM,CAdJ,EAGA,yBASS,GARPG,GAAG,UACHS,KAAK,KACLL,KAAK,O,WACI,EAAAM,KAAKC,KAAKK,Q,qDAAV,EAAAN,KAAKC,KAAKK,QAAO,IAC1BnB,MAAK,CAAC,eAAc,cAEIW,EAAO,QAD/BM,YAAY,QAEZD,MAAM,Y,+BAER,yBAAkE,GAAnDJ,KAAK,KAAKZ,MAAM,uBAEjC,EAIA,M,uBAQJ,yBAqDM,MArDN,EAqDM,CApDJ,yBAmDM,MAnDN,EAmDM,CAlDJ,EACA,G,2BACA,yBAWM,2CATW,EAAAoB,MAAMC,MAAI,SAAlBC,G,gCAFT,yBAWM,OAVJtB,MAAM,6CAELuB,IAAKD,EAAKnB,I,CAEX,yBAA2C,OAArCqB,IAAKF,EAAKG,QAAQC,SAAUC,IAAI,I,gBACtC,yBAGM,MAHN,EAGM,CAFJ,yBAAsD,OAAtD,EAAsD,6BAA7BL,EAAKG,QAAQG,OAAK,GAC3C,yBAAsE,OAAtE,EAAkC,OAAI,6BAAGN,EAAKG,QAAQI,OAAK,KAE7D,yBAAuD,MAAvD,EAAiC,KAAE,6BAAGP,EAAKQ,KAAG,Q,MAEhD,yBAUK,KAVL,EAUK,CATH,yBAGK,KAHL,EAGK,CAFH,EACA,yBAAwB,SAArB,IAAC,6BAAG,EAAAC,YAAU,KAEnB,yBAIK,KAJL,EAIK,CAHH,EAC8B,EAAAA,YAAU,K,yBAAxC,yBAAuD,IAAvD,EAAiD,Q,yBACjD,yBAAsC,IAAtC,EAA+B,YAGnC,EAGA,yBAUM,MAVN,EAUM,C,4BATJ,yBAOE,SANAxB,KAAK,OACLP,MAAM,eACNiB,YAAY,Q,qDACH,EAAAe,OAAM,IACfC,aAAW,WACXC,mBAAiB,gB,4BAFR,EAAAF,UAIX,yBAA2F,QAArFhC,MAAM,gCAAgCG,GAAG,eAAgB,QAAK,8BAAE,EAAAgC,YAAA,EAAAA,WAAA,sBAAY,QAEpF,EACA,yBAIM,MAJN,EAIM,CAHJ,EACiC,EAAAJ,YAAU,K,yBAA3C,yBAA4E,OAA5E,EAAoD,IAAC,6BAAG,EAAAA,YAAU,K,yBAClE,yBAA+D,OAA/D,EAAkC,IAAC,6BAAG,EAAAA,WAAU,UAEc,IAAT,EAAAK,W,yBAAvD,yBAIM,MAJN,EAIM,CAHJ,EAC6C,EAAAL,YAAU,K,yBAAvD,yBAAmG,OAAnG,EAAgE,IAAC,6BAAGM,KAAKC,MAAM,EAAAF,YAAS,K,yBACxF,yBAAsF,OAAtF,EAA8C,IAAC,6BAAGC,KAAKC,MAAM,EAAAF,WAAS,W,8HAcrE,GACbG,MADa,WAEX,IAAMnB,EAAQ,eAAS,CACrBC,KAAM,KAEFZ,EAAY,gBAAI,GAChBsB,EAAa,eAAI,GACjBC,EAAS,eAAI,IACbI,EAAY,eAAI,GAChBvB,EAAO,eAAS,CACpBC,KAAM,CACJF,KAAM,GACNG,MAAO,GACPG,IAAK,GACLC,QAAS,MAGPqB,EAAS,iBACTC,EAAO,eAAO,QACdC,EAAQ,eAAO,SACfC,EAAU,WACd,IAAMC,EAAE,UAAO,wCAAP,eAAqC,YAArC,SACRnC,EAAUoC,OAAQ,EAClBH,EAAMI,IAAIF,GAAKG,MAAK,SAAAC,GAClB5B,EAAMC,KAAO2B,EAAI3B,KAAKA,KAAKD,MAC3B6B,IACAxC,EAAUoC,OAAQ,MAGhBI,EAAgB,WACpBlB,EAAWc,MAAQ,EACnBzB,EAAMC,KAAK6B,SAAQ,SAAA5B,GACjBS,EAAWc,OAASvB,EAAK6B,UAGvBhB,EAAa,WACjB,IAAMS,EAAE,UAAO,wCAAP,eAAqC,YAArC,WACRnC,EAAUoC,OAAQ,EAClB,IAAMxB,EAAO,CACX+B,KAAMpB,EAAOa,OAEfH,EAAMW,KAAKT,EAAK,CAAEvB,SAAQ0B,MAAK,SAAAC,GACzBA,EAAI3B,KAAKiC,SACX,eAAeN,GACfvC,EAAUoC,OAAQ,EAClBT,EAAUS,MAAQG,EAAI3B,KAAKA,KAAKkC,cAEhC,eAAeP,GACfvC,EAAUoC,OAAQ,OAIlBnC,EAAU,WACdD,EAAUoC,OAAQ,EAClB,IAAMD,EAAE,UAAO,wCAAP,eAAqC,YAArC,UACRF,EAAMW,KAAKT,EAAK,CAAEvB,KAAMR,IAAQkC,MAAK,SAAAC,GACnCvC,EAAUoC,OAAQ,EAClBJ,EAAKe,KAAK,eACVhB,EAAOiB,KAAP,iBAAsBT,EAAI3B,KAAKqC,cAMnC,OAHA,iBAAU,WACRf,OAEK,CACLR,aACAzB,UACAU,QACAW,aACAK,YACAvB,OACAJ,YACAuB,YC5NN,EAAO2B,OAASA,EAED,gB,qBCLf,IAAIC,EAAc,EAAQ,QACtBC,EAAiB,EAAQ,QAAuCC,EAEhEC,EAAoBC,SAASC,UAC7BC,EAA4BH,EAAkBI,SAC9CC,EAAS,wBACTC,EAAO,OAIPT,KAAiBS,KAAQN,IAC3BF,EAAeE,EAAmBM,EAAM,CACtCC,cAAc,EACdxB,IAAK,WACH,IACE,OAAOoB,EAA0BK,KAAKC,MAAMC,MAAML,GAAQ,GAC1D,MAAOM,GACP,MAAO","file":"js/chunk-43277106.899bf969.js","sourcesContent":["<template>\r\n  <Loading :active=\"isLoading\"></Loading>\r\n  <div class=\"checkout\">\r\n    <div class=\"banner bg-cover\"></div>\r\n    <div class=\"container mt-5\">\r\n      <div class=\"row mb-4\">\r\n        <div class=\"col-md-7 order-md-0 order-1 mt-md-0 mt-5\">\r\n          <h2 class=\"fw-bold\">訂購人資訊</h2>\r\n          <hr class=\"bg-dark\" style=\"opacity: 1\" />\r\n          <Form v-slot=\"{ errors }\" @submit=\"toOrder\">\r\n            <div class=\"mb-2\">\r\n              <label for=\"email\" class=\"form-label fw-bold\"\r\n                ><span class=\"text-danger\">*</span> Email</label\r\n              >\r\n              <Field\r\n                id=\"email\"\r\n                name=\"email\"\r\n                type=\"email\"\r\n                class=\"form-control\"\r\n                v-model=\"form.user.email\"\r\n                :class=\"{ 'is-invalid': errors['email'] }\"\r\n                rules=\"email|required\"\r\n                placeholder=\"請輸入 Email\"\r\n              ></Field>\r\n              <error-message name=\"email\" class=\"invalid-feedback\"></error-message>\r\n            </div>\r\n            <div class=\"mb-2\">\r\n              <label for=\"name\" class=\"form-label fw-bold\"\r\n                ><span class=\"text-danger\">*</span> 收件人姓名</label\r\n              >\r\n              <Field\r\n                id=\"name\"\r\n                name=\"姓名\"\r\n                type=\"text\"\r\n                v-model=\"form.user.name\"\r\n                class=\"form-control\"\r\n                placeholder=\"請輸入姓名\"\r\n                :class=\"{ 'is-invalid': errors['姓名'] }\"\r\n                rules=\"required\"\r\n              ></Field>\r\n              <error-message name=\"姓名\" class=\"invalid-feedback\"></error-message>\r\n            </div>\r\n\r\n            <div class=\"mb-2\">\r\n              <label for=\"tel\" class=\"form-label fw-bold\"\r\n                ><span class=\"text-danger\">*</span> 收件人電話</label\r\n              >\r\n              <Field\r\n                id=\"tel\"\r\n                name=\"電話\"\r\n                type=\"text\"\r\n                class=\"form-control\"\r\n                v-model=\"form.user.tel\"\r\n                placeholder=\"請輸入電話\"\r\n                :class=\"{ 'is-invalid': errors['電話'] }\"\r\n                rules=\"required|min:8|max:10\"\r\n              ></Field>\r\n              <error-message name=\"電話\" class=\"invalid-feedback\"></error-message>\r\n            </div>\r\n            <div class=\"mb-2\">\r\n              <label for=\"address\" class=\"form-label fw-bold\"\r\n                ><span class=\"text-danger\">*</span> 收件人地址</label\r\n              >\r\n              <Field\r\n                id=\"address\"\r\n                name=\"地址\"\r\n                type=\"text\"\r\n                v-model=\"form.user.address\"\r\n                class=\"form-control\"\r\n                placeholder=\"請輸入地址\"\r\n                :class=\"{ 'is-invalid': errors['地址'] }\"\r\n                rules=\"required\"\r\n              ></Field>\r\n              <error-message name=\"地址\" class=\"invalid-feedback\"></error-message>\r\n            </div>\r\n            <div class=\"mb-2\">\r\n              <label for=\"message\" class=\"form-label fw-bold\">留言 (選填)</label>\r\n              <textarea id=\"message\" class=\"form-control\" cols=\"20\" rows=\"10\"></textarea>\r\n            </div>\r\n            <div class=\"d-flex justify-content-between\">\r\n              <a href=\"#/cart\" class=\"btn-custom2 hvr-shutter-out-horizontal my-2\"\r\n                >上一步</a\r\n              >\r\n              <button type=\"submit\" class=\"btn btn-lg btn-outline-primary fw-bold btn-custom hvr-bounce-to-right my-2\">下一步</button>\r\n            </div>\r\n          </Form>\r\n        </div>\r\n        <div class=\"col-md-5\">\r\n          <div class=\"order\">\r\n            <h3 class=\"fw-bold text-center\">訂單明細</h3>\r\n            <hr class=\"bg-dark\" style=\"opacity: 1\" />\r\n            <div\r\n              class=\"orderDetail py-1 d-flex align-items-center\"\r\n              v-for=\"item in carts.data\"\r\n              :key=\"item.id\"\r\n            >\r\n              <img :src=\"item.product.imageUrl\" alt=\"\" />\r\n              <div class=\"title-price d-flex flex-column ms-2\">\r\n                <span class=\"fw-bold\">{{ item.product.title }} </span>\r\n                <span class=\"fw-bold text-danger\">NT ${{ item.product.price }} </span>\r\n              </div>\r\n              <div class=\"num fw-bold ms-auto\">X {{ item.qty }}</div>\r\n            </div>\r\n            <ul class=\"list-unstyled mt-2\">\r\n              <li class=\"fw-bold d-flex justify-content-between mb-1\">\r\n                <p>小計</p>\r\n                <p>${{ totalPrice }}</p>\r\n              </li>\r\n              <li class=\"fw-bold d-flex justify-content-between\">\r\n                <p>外送費</p>\r\n                <p class=\"text-success\" v-if=\"totalPrice >= 599\">$0</p>\r\n                <p class=\"text-success\" v-else>$80</p>\r\n              </li>\r\n            </ul>\r\n            <small class=\"text-danger d-flex justify-content-end fw-bold\"\r\n              >消費金額滿599元免運費</small\r\n            >\r\n            <div class=\"input-group mb-3\">\r\n              <input\r\n                type=\"text\"\r\n                class=\"form-control\"\r\n                placeholder=\"輸入優惠券\"\r\n                v-model=\"coupon\"\r\n                aria-label=\"Username\"\r\n                aria-describedby=\"basic-addon1\"\r\n              />\r\n              <span class=\"input-group-text send fw-bold\" id=\"basic-addon1\" @click=\"sendCoupon\">送出</span>\r\n            </div>\r\n            <hr class=\"bg-dark\" style=\"opacity: 1\" />\r\n            <div class=\"total d-flex justify-content-between\">\r\n              <h4 class=\"fw-bold\">總金額</h4>\r\n              <span class=\"fs-4 fw-bold\" v-if=\"totalPrice >= 599\">${{ totalPrice }}</span>\r\n              <span class=\"fs-4 fw-bold\" v-else>${{ totalPrice + 80 }}</span>\r\n            </div>\r\n            <div class=\"sale d-flex justify-content-between\" v-if=\"salePrice !== 0\">\r\n              <h4 class=\"fw-bold text-danger\">優惠價</h4>\r\n              <span class=\"fs-4 fw-bold text-danger\" v-if=\"totalPrice >= 599\">${{ Math.round(salePrice) }}</span>\r\n              <span class=\"fs-4 fw-bold text-danger\" v-else>${{ Math.round(salePrice) + 80 }}</span>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { reactive, ref } from '@vue/reactivity'\r\nimport { inject, onMounted } from '@vue/runtime-core'\r\nimport { useSweetalert2 } from '../composition-api'\r\nimport { useRouter } from 'vue-router'\r\nexport default {\r\n  setup () {\r\n    const carts = reactive({\r\n      data: []\r\n    })\r\n    const isLoading = ref(false)\r\n    const totalPrice = ref(0)\r\n    const coupon = ref('')\r\n    const salePrice = ref(0)\r\n    const form = reactive({\r\n      user: {\r\n        name: '',\r\n        email: '',\r\n        tel: '',\r\n        address: ''\r\n      }\r\n    })\r\n    const router = useRouter()\r\n    const mitt = inject('mitt')\r\n    const axios = inject('axios')\r\n    const getCart = () => {\r\n      const api = `${process.env.VUE_APP_URL}api/${process.env.VUE_APP_PATH}/cart`\r\n      isLoading.value = true\r\n      axios.get(api).then(res => {\r\n        carts.data = res.data.data.carts\r\n        getTotalPrice()\r\n        isLoading.value = false\r\n      })\r\n    }\r\n    const getTotalPrice = () => {\r\n      totalPrice.value = 0\r\n      carts.data.forEach(item => {\r\n        totalPrice.value += item.total\r\n      })\r\n    }\r\n    const sendCoupon = () => {\r\n      const api = `${process.env.VUE_APP_URL}api/${process.env.VUE_APP_PATH}/coupon`\r\n      isLoading.value = true\r\n      const data = {\r\n        code: coupon.value\r\n      }\r\n      axios.post(api, { data }).then(res => {\r\n        if (res.data.success) {\r\n          useSweetalert2(res)\r\n          isLoading.value = false\r\n          salePrice.value = res.data.data.final_total\r\n        } else {\r\n          useSweetalert2(res)\r\n          isLoading.value = false\r\n        }\r\n      })\r\n    }\r\n    const toOrder = () => {\r\n      isLoading.value = true\r\n      const api = `${process.env.VUE_APP_URL}api/${process.env.VUE_APP_PATH}/order`\r\n      axios.post(api, { data: form }).then(res => {\r\n        isLoading.value = false\r\n        mitt.emit('update-cart')\r\n        router.push(`/order/${res.data.orderId}`)\r\n      })\r\n    }\r\n    onMounted(() => {\r\n      getCart()\r\n    })\r\n    return {\r\n      sendCoupon,\r\n      toOrder,\r\n      carts,\r\n      totalPrice,\r\n      salePrice,\r\n      form,\r\n      isLoading,\r\n      coupon\r\n    }\r\n  }\r\n}\r\n</script>\r\n","import { render } from \"./Checkout.vue?vue&type=template&id=6f032a10\"\nimport script from \"./Checkout.vue?vue&type=script&lang=js\"\nexport * from \"./Checkout.vue?vue&type=script&lang=js\"\nscript.render = render\n\nexport default script","var DESCRIPTORS = require('../internals/descriptors');\nvar defineProperty = require('../internals/object-define-property').f;\n\nvar FunctionPrototype = Function.prototype;\nvar FunctionPrototypeToString = FunctionPrototype.toString;\nvar nameRE = /^\\s*function ([^ (]*)/;\nvar NAME = 'name';\n\n// Function instances `.name` property\n// https://tc39.es/ecma262/#sec-function-instances-name\nif (DESCRIPTORS && !(NAME in FunctionPrototype)) {\n  defineProperty(FunctionPrototype, NAME, {\n    configurable: true,\n    get: function () {\n      try {\n        return FunctionPrototypeToString.call(this).match(nameRE)[1];\n      } catch (error) {\n        return '';\n      }\n    }\n  });\n}\n"],"sourceRoot":""}